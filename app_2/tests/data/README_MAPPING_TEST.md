# OCRçµæœ & ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿

ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã¯ã€OCRã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ†ã‚¹ãƒˆçµæœã¨ã€ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ã®ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

### ğŸ–¼ï¸ **å…ƒç”»åƒãƒ•ã‚¡ã‚¤ãƒ«**
- `menu_test.webp` - ã‚«ãƒ•ã‚§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒ (260KB)
- `menu_test2.jpg` - å±…é…’å±‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»åƒ (165KB)

### ğŸ“‹ **OCRå®Œå…¨çµæœ**
- `ocr_result_menu_test_webp.json` - ã‚«ãƒ•ã‚§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å®Œå…¨OCRçµæœ
- `ocr_result_menu_test2_jpg.json` - å±…é…’å±‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®å®Œå…¨OCRçµæœ

### ğŸ—ºï¸ **ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿**
- `mapping_test_data_cafe.json` - ã‚«ãƒ•ã‚§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒãƒƒãƒ”ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿
- `mapping_test_data_izakaya.json` - å±…é…’å±‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ãƒãƒƒãƒ”ãƒ³ã‚°ç”¨ãƒ‡ãƒ¼ã‚¿

## ğŸ“Š **ãƒ‡ãƒ¼ã‚¿è©³ç´°**

### **ã‚«ãƒ•ã‚§ãƒ¡ãƒ‹ãƒ¥ãƒ¼ (`menu_test.webp`)**
```json
{
  "å‡¦ç†æ™‚é–“": "0.345ç§’",
  "æŠ½å‡ºè¦ç´ æ•°": 30,
  "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç¨®é¡": ["COFFEE", "TEA", "JUICE", "DESSERT"],
  "ä¾¡æ ¼å¸¯": "Â¥400-Â¥600"
}
```

### **å±…é…’å±‹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ (`menu_test2.jpg`)**
```json
{
  "å‡¦ç†æ™‚é–“": "0.34ç§’", 
  "æŠ½å‡ºè¦ç´ æ•°": 94,
  "ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç¨®é¡": ["ã‚„ãã¨ã‚Š", "ã‚µãƒ©ãƒ€", "ãŠé…’", "æšã’ç‰©", "ãƒ‡ã‚¶ãƒ¼ãƒˆ", "ã‚½ãƒ•ãƒˆãƒ‰ãƒªãƒ³ã‚¯"],
  "ä¾¡æ ¼å¸¯": "Â¥200-Â¥700"
}
```

## ğŸ§ª **ãƒ†ã‚¹ãƒˆç”¨é€”**

### **1. ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ãƒ†ã‚¹ãƒˆ**
```python
# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ä¾‹
import json

with open('mapping_test_data_cafe.json', 'r', encoding='utf-8') as f:
    cafe_ocr_data = json.load(f)

# ãƒãƒƒãƒ”ãƒ³ã‚°ã‚µãƒ¼ãƒ“ã‚¹ã§ãƒ†ã‚¹ãƒˆ
from app_2.services.mapping_service import get_menu_mapping_categorize_service
mapping_service = get_menu_mapping_categorize_service()
formatted_data = mapping_service._format_mapping_data(cafe_ocr_data)
```

### **2. ã‚«ãƒ†ã‚´ãƒ©ã‚¤ã‚ºå‡¦ç†ãƒ†ã‚¹ãƒˆ**
```python
# ãƒãƒƒãƒ”ãƒ³ã‚°çµæœã§ã‚«ãƒ†ã‚´ãƒ©ã‚¤ã‚ºãƒ†ã‚¹ãƒˆ
categorize_result = await mapping_service.categorize_mapping_data(
    cafe_ocr_data, level="paragraph"
)
```

### **3. å‡¦ç†æ™‚é–“ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯**
```python
# OCR â†’ Mapping â†’ Categorize ã®æ®µéšåˆ¥å‡¦ç†æ™‚é–“æ¸¬å®š
import time

# 1. OCRæ®µéš (å®Ÿæ¸¬å€¤)
ocr_time = 0.345  # seconds

# 2. Mappingæ®µéš (ãƒ†ã‚¹ãƒˆå¯¾è±¡)
start = time.time()
formatted_data = mapping_service._format_mapping_data(cafe_ocr_data)
mapping_time = time.time() - start

# 3. Categorizeæ®µéš (ãƒ†ã‚¹ãƒˆå¯¾è±¡)
start = time.time()
categorize_result = await categorize_service.categorize_menu_structure(
    formatted_data, "paragraph"
)
categorize_time = time.time() - start

print(f"OCR: {ocr_time:.3f}s")
print(f"Mapping: {mapping_time:.3f}s") 
print(f"Categorize: {categorize_time:.3f}s")
print(f"Total: {ocr_time + mapping_time + categorize_time:.3f}s")
```

## ğŸ¯ **æœŸå¾…ã•ã‚Œã‚‹çµæœ**

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™**
- **OCR**: âœ… 0.3-1.0ç§’ (é”æˆæ¸ˆã¿)
- **Mapping**: ğŸ¯ <0.1ç§’ (è»½é‡å‡¦ç†)
- **Categorize**: âš ï¸ <5ç§’ (ç¾åœ¨ã®å•é¡Œç®‡æ‰€)

### **ãƒ‡ãƒ¼ã‚¿å“è³ªç¢ºèª**
- åº§æ¨™æƒ…å ±ã®æ­£ç¢ºæ€§
- ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºã®å®Œå…¨æ€§
- ä¾¡æ ¼ã¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼åã®æ­£ã—ã„åˆ†é›¢
- ã‚«ãƒ†ã‚´ãƒªåˆ¤å®šã®å¦¥å½“æ€§

## ğŸš€ **ä½¿ç”¨ä¾‹**

### **ãƒãƒƒãƒ”ãƒ³ã‚°ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆæ™‚**
ã“ã‚Œã‚‰ã®ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€ãƒãƒƒãƒ”ãƒ³ã‚°å‡¦ç†ã®å˜ä½“ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ä½œæˆã—ã€å‡¦ç†æ™‚é–“ã‚’æ¸¬å®šã§ãã¾ã™ã€‚

### **ã‚«ãƒ†ã‚´ãƒ©ã‚¤ã‚ºã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆæ™‚**
ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆæ¸ˆã¿ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã€OpenAI Categorizeå‡¦ç†ã®å˜ä½“ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã™ã€‚

### **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**
å„æ®µéšã®å‡¦ç†æ™‚é–“ã‚’å€‹åˆ¥ã«æ¸¬å®šã™ã‚‹ã“ã¨ã§ã€48ç§’å•é¡Œã®ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ç‰¹å®šã«æ´»ç”¨ã§ãã¾ã™ã€‚